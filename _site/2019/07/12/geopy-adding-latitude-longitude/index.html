<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Adding Latitude and Longitude given a location using Geocoder library | SWC - Data Science</title><meta name="author" content="Sangwook Cheon"><meta name="description" content="N(one)-Stop Data Science"><meta property="og:title" content="Adding Latitude and Longitude given a location using Geocoder library | SWC - Data Science"><meta property="og:url" content="http://localhost:4000/2019/07/12/geopy-adding-latitude-longitude/"><meta property="og:site_name" content="SWC - Data Science"><meta property="og:description" content="How to add Latitude and Longitude given a location using Geocoder library"><meta property="og:image" content="/images/nasa-_SFJhRPzJHs-unsplash (1).jpg"><meta property="og:type" content="blog"><meta name="twitter:card" content="summary"><meta name="twitter:description" content="How to add Latitude and Longitude given a location using Geocoder library"><meta name="twitter:title" content="Adding Latitude and Longitude given a location using Geocoder library | SWC - Data Science"><meta name="twitter:url" content="http://localhost:4000/2019/07/12/geopy-adding-latitude-longitude/"><meta name="twitter:site" content="SWC - Data Science"><meta name="twitter:creator" content="@"><meta name="twitter:domain" content="http://localhost:4000"><meta property="twitter:image" content="/images/nasa-_SFJhRPzJHs-unsplash (1).jpg"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata|Lora|Space+Mono:700"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" href="/assets/css/main.css"><link rel="alternate" type="application/rss+xml" title="SWC - Data Science" href="http://localhost:4000/feed.xml"><link rel="canonical" href="http://localhost:4000/2019/07/12/geopy-adding-latitude-longitude/"></head><main><style media="screen"> #particles-js { background-image: url('/images/nasa-_SFJhRPzJHs-unsplash (1).jpg'); background-color: $color-black; background-repeat: no-repeat; background-size: cover; background-position: 50%; animation: fade-in 3s both; position: absolute; top: 0; left: 0; height: 100%; width: 100%; background-size: cover; background-repeat: no-repeat; /* background-position: 50%; */ @media not all and (hover:hover) { height: var(--app-height); } @media (min-width: 30em) { height: 35em; } &:after { @extend %overlay; } &__img { animation: fade-in 2s both; } &__container { display: flex; flex-direction: column; justify-content: flex-end; height: 100%; width: 90%; margin: 0 auto; } } p { font-size: 1.114em; margin-bottom: 1.3em; } ol, ul { margin: 1em; padding: 0; font-size: 1.114em; } .centered { position: absolute; top: 17.5em; left: 5%; width: 80%; justify-content: flex-end; margin: 0 auto; flex-direction: column; /* transform: translate(-50%, -50%); */ } .bottom-left { position: absolute; top: 40%; left: 10%; } html { scroll-behavior: smooth; } mark { background-color: $color-alpha; color: $color-black; padding: 2px; border-radius: 5px; }</style><article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"><header class="mast rellax" data-rellax-speed="-4"> <a class="nav nav--white" href="/"> <i class="fa fa-lg fa-arrow-left"></i> <span>Back to Posts</span> </a><div id='particles-js'></div><div class="mast__container"> <br> <span style="color:#ffffff"><time datetime="2019-07-12T00:00:00+07:00" itemprop="datePublished">Jul 12, 2019</time></span><h1 style="font-family: $font-header;color:#ffffff" itemprop="name headline">Adding Latitude and Longitude given a location using Geocoder library</h1><hr> <span style="color:#ffffff; font-size:1.114em;">Posted in <a class="nav--white" href="/category/learn-ds"><mark>Learn-DS</mark></a>, <a class="nav--white" href="/category/obtaining-data"><mark>Obtaining-Data</mark></a> </span> <span></span> <br></div></header><section class="section-padding bg-grey" itemprop="articleBody"><div class="post"><h1 id="about-geocoder">About Geocoder</h1><p><a href="https://geocoder.readthedocs.io/">Geocoder</a> is a python library that enables us to get Latitude and Longitude value given an address anywhere in the world. I will work with the cleaned dataset I created with Beautiful soup from this <a href="https://sangwookcheon.github.io/2019/07/12/web-scraping-using-beautiful-soup/">article</a>. I will Latitude and Longitude coordinates to each Postal Code.</p><p>It is important to note that Geocoder library can sometimes be inconsistent, returning ‘None’ instead of coordinates. This library is free-of-charge, but you might want to use a more stable but paid service like <a href="https://developers.google.com/maps/documentation/geocoding/start">Google Geocoding API</a>. For this task, using Geocoder library is enough.</p><p>First let’s import Geocoder library and other tools:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">geocoder</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
</code></pre></div></div><p><img src="/in-post-images/Screen Shot 2019-07-12 at 22.16.09.png" alt="" /> Here are the first 10 rows of my cleaned table. In total, there are 103 rows, meaning that there are 103 unique postal codes.</p><p>We first need to initialize lat-long coordinates to be an empty list, which will be filled for each postal code and added to the table. We also need to get postal codes from the table.</p><p>I stored the clean data table as <code class="highlighter-rouge">data</code> by using <code class="highlighter-rouge">read_csv</code> function of Pandas.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># initialize variable to None</span>
<span class="n">lat_lng_coords</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">postal_codes</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'PostalCode'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></div><p>Now is the part where I loop until coordinates are derived from the <code class="highlighter-rouge">geocoder.google</code> function, and then add it to the original table.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># loop until we get the coordinates</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">code</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">postal_codes</span><span class="p">):</span>
    <span class="k">while</span><span class="p">(</span><span class="n">lat_lng_coords</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">geocoder</span><span class="o">.</span><span class="n">google</span><span class="p">(</span><span class="s">'{}, Toronto, Ontario'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">))</span>
        <span class="n">lat_lng_coords</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">latlng</span>
        <span class="k">print</span><span class="p">(</span><span class="n">lat_lng_coords</span><span class="p">)</span>

    <span class="n">latitude</span> <span class="o">=</span> <span class="n">lat_lng_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">longitude</span> <span class="o">=</span> <span class="n">lat_lng_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'Latitude'</span><span class="p">]</span> <span class="o">=</span> <span class="n">latitude</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'Longitude'</span><span class="p">]</span> <span class="o">=</span> <span class="n">longitude</span>

    <span class="c">#Re-initialize the variable.</span>
    <span class="n">lat_lng_coords</span> <span class="o">=</span> <span class="bp">None</span>
</code></pre></div></div><p>Doing this might take some time, because there is loading time when getting coordinates. When finished, now there is an updated table with two new columns, named <code class="highlighter-rouge">latitude</code> and <code class="highlighter-rouge">longitude</code>, as shown below: <img src="/in-post-images/Screen Shot 2019-07-13 at 11.45.23.png" alt="" /></p><h1 id="recap">Recap</h1><p>Geocoder library can be used to get latitude and longitude values using a street address. This library is free-of-charge, but can sometimes be inconsistent in yielding results.</p><p>Getting coordinates is important in many applications, such as putting marks on trending places on a map and clustering places based on their latitude and longitude values.</p><p>Here is a <a href="https://github.com/SangwookCheon/non-e-stop-python-data-science/blob/master/Machine-Learning/Example%20Projects/IBM%20Capstone%20Project/add_latlon.ipynb">link to Jupyter Notebook</a> for this article.</p><p>You can also learn about Foursquare API, a map-related API with many social features, by referring to <a href="https://github.com/SangwookCheon/non-e-stop-python-data-science/blob/master/Machine-Learning/Example%20Projects/IBM%20Capstone%20Project/foursquare_api_exploration.ipynb">this notebook</a>.</p><div id="disqus_thread"></div><script> var disqus_config = function () { this.page.url = "http://localhost:4000/2019/07/12/geopy-adding-latitude-longitude/"; this.page.identifier = "/2019/07/12/geopy-adding-latitude-longitude"; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://sangwookcheon.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section><section class="profile"><div class="profile__card"><div class="profile__img"><figure class="absolute-bg" style="background-image: url('/images/SangwookCpic.png');"></figure></div><div class="profile__container"><p>My name is Sangwook Cheon, a high school student at Jakarta Intercultural School. After tinkering with various branches of technology, I discovered that I am most passionate about data. All kinds of data, from so well-known to absolutely obscure. I work with Python to extract and interact with numbers, texts, images, audio, and more to come soon.</p><ul class="profile__social"><li><a class="fa fa-lg fa-envelope-o" href="mailto:sangwookchn@gmail.com"></a></li><li><h3><a href="https://kaggle.com/sangwookchn">k</a></h3></li><li><a class="fa fa-lg fa-github" href="https://github.com/SangwookCheon" target="_blank"></a></li><li><a class="fa fa-lg fa-linkedin" href="https://www.linkedin.com/in/sangwookcheon/" target="_blank"></a></li><li><a class="fa fa-lg fa-medium" href="https://medium.com/@sangwookcheon" target="_blank"></a></li></ul></div></div></section></article><section class="next"> <a class="next__link" href="/2019/07/09/how-created-portfolio/" style="background-image: url('/images/chalkboard_leaves.jpg');"><div class="next__container"> <span style="color:#ffffff;">Read Next</span><h3 style="color:#ffffff">How I Created my own Personal Portfolio</h3></div></a></section></main><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/rellax/1.0.0/rellax.min.js"></script> <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script> <script src="//cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script> <script> particlesJS.load('particles-js', "/assets/js/particles.json", function() { console.log('callback - particles.js config loaded'); }); </script> <script type="text/javascript" src="/assets/js/app.js"></script></body></html>
